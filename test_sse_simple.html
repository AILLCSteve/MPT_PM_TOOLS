<!DOCTYPE html>
<html>
<head>
    <title>SSE Test</title>
</head>
<body>
    <h1>SSE Test</h1>
    <div id="log"></div>

    <script>
        const log = document.getElementById('log');

        function addLog(message) {
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `<div>[${time}] ${message}</div>`;
        }

        // Connect to SSE
        const eventSource = new EventSource('/test-sse');

        eventSource.onopen = () => {
            addLog('‚úÖ Connected to SSE');
        };

        eventSource.onmessage = (e) => {
            addLog(`üì® Received: ${e.data}`);

            try {
                const data = JSON.parse(e.data);
                addLog(`üì¶ Parsed: ${data.event} - ${data.message}`);
            } catch (err) {
                addLog(`‚ùå Parse error: ${err.message}`);
            }
        };

        eventSource.onerror = (err) => {
            addLog(`‚ùå SSE Error`);
            console.error(err);
        };
    </script>
</body>
</html>
